<template name="addTopicComment">
<style type="text/css">
  #publishto {
    /*position: absolute;*/
    /*top: 420px;*/
    /*left: 2%;*/
    /*right: 2%;*/
  }

  #publishto .publish-readers-list {
    list-style: none;
    padding-left: 0;
  }

  #publishto .publish-reader-group {
    /*border-bottom: 1px solid #ededed;*/
    /*margin-bottom: 10px;*/
  }

  #publishto .publish-reader-group label.selected {
    color: #A6A4A4;
  }  

  /* #publishto .publish-reader-group input[type='checkbox']{ */
  input[type='checkbox']{
    background: none;
    border: none;
    -webkit-appearance: none;
    appearance: none;
    margin-right: 10px;
    position: relative;
    /*bottom: -10px;*/
    outline: none !important;
  }

  /* #publishto .publish-reader-group input[type='checkbox']:checked:after{ */
  input[type='checkbox']:checked:after{
    content: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 -15 100 120"><circle cx="50" cy="50" r="50" fill="none" stroke="#00c4ff" stroke-width="10"/><path fill="#00c4ff" d="M72 25L42 71 27 56l-4 4 20 20 34-52z"/></svg>');
  }

  /* #publishto .publish-reader-group input[type='checkbox']:after{ */
  input[type='checkbox']:after{
    content: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 -15 100 120"><circle cx="50" cy="50" r="50" fill="none" stroke="#aaaaaa" stroke-width="10"/></svg>');
  }

  #publishto .publish-reader-group label label {
    display: inline-block;
    max-width: 65%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  #pubdivide {
    margin-top: 8px;
    margin-left: -3%;
    margin-right: -3%;
    height: 10px;
    border: 1px solid #E9E9ED;
    background-color: #EFEFF4; 
  }
</style>

<div class="addTopicComment">
{{> Template.dynamic template=template data=data }}
<div class="content">
  <div id="title">{{_ "yourStoryPublished"}}</div>
  <div><textarea id="comment" placeholder="{{_ 'addTopicOrComment'}}" maxlength="150">{{comment}}</textarea></div>
  <div id="topics">{{_ "hotTopics"}}
      {{#each topics}}
          <span id="topic">
          &nbsp;
          #{{text}}#
          &nbsp;
          </span>
      {{/each}}
      {{#if isShowPublish}}
      <div id="pubdivide"></div> 
      <ul  class="publish-readers-list1" style="padding:0; margin: 10px auto; text-align:center">
          <li class="publish-reader-group1" style="padding:0;margin: 0 auto;height: 46px;max-width: 250px;display: block;">
            <label style="margin:0;margin-top:2px; padding:0;height: 46px; display: table-cell; width:46px;"><input id="share-follower" type="checkbox"></label>
            <label for="share-follower" style="display: table-cell; padding: 0; margin: 0; vertical-align: middle; line-height:46px;">分享本文到故事贴读友圈</label>
          </li> 
        </ul>  
      <div id="pubdivide"></div> 
      <div id="publishto">
        <h4 style="text-align:center;">{{_ "publishTo"}}</h4>
        {{#if has_share_push}}
        <!--<ul class="publish-readers-list1">
          <li class="publish-reader-group1">
            <label><input id="share-follower" type="checkbox"><label for="share-follower">点击选择朋友圈，分享这篇故事给朋友</label></label>
          </li>  
        </ul>  -->
        {{/if}}
        <!--{{> publishReadersList}}-->
        <!--<ul class="publish-readers-list">
          {{#each groups}}
            <li class="publish-reader-group">
              <label><input id="{{postId}}" type="checkbox"><label for="{{postId}}">{{title}}</label> ({{browse}} {{_ "readerUnit"}})</label>
            </li>      
          {{/each}}
        </ul>-->
        <div class="waterfall">
          {{#each groups}}
            <div class="pin" id={{postId}}>
              <div class="img_placeholder">
                <div class="selectHelper" style="background:rgba(0,0,0,.28); border-radius:50%;">
                  <img src="/select_n.png" style="width:26px;"/>
                </div>
                <div class="img-container"><img src="{{mainImage}}" /></div>
              </div>
              <div class="context" style="margin:5px;">{{title}}</div>
              <div class="context" style="margin:5px; border-top:1px solid #eee; padding-top: 6px;">
                读友圈有<span style="color:#00c4ff;">{{browse}}</span>位读者
              </div>
            </div>
          {{/each}}
        </div>

      </div>
      {{/if}}
  </div>
  <div id="save">{{_ "OK"}}</div>
</div>
</div>
</template>

<template name="publishReadersList">
<div class="publish-readers-list">
  <style>
    .img_placeholder:after{
      content: url(/select_n.svg);
      position: absolute;
      top: 5px;
      right: 5px;
      width: 32px;
      height: 32px;
      background: rgba(0, 0, 0, 0.36);
      border-radius: 50%;
      display: block;
    }
    .select >.img_placeholder:after{
      content: '';
      display: none !important;
    }
    .newLayout_element.select:before{
      background: rgba(0, 196, 255, 0.1);
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      content: '.';
      color: rgba(0,0,0,0);
      border-radius: 4px;
    }
    .newLayout_element.select:after{
      content: url(/select_p.svg);
      position: absolute;
      top: 5px;
      right: 5px;
      width: 32px;
      height: 32px;
      display: block;
    }
  </style>
  <div class="newLayout_container newLayout_container_moments_" style="background:#ffffff; margin-top:10px; overflow-x:hidden;">
    {{#each groups}} 
      <div class="newLayout_element newLayout_element_moments_" id="{{postId}}" style="border-radius: 5px; background-color: #f7f7f7;">
        <div class="img_placeholder">
          <img class="mainImage" src="{{mainImage}}" />
        </div>
        <div class="pin_content">
          <p class="title">{{title}}</p>
          <p class="addontitle">{{addontitle}}</p>
          <h1 class="username">{{browse}} <span> {{_ "readerUnit"}}</span></h1>
        </div>
      </div>
    {{/each}} 
  </div>
  {{#if isLoading}}
  <div class="loading-spinner">
    <div class='spinner-overlay'>
      <div class='spinner center'>
        <div class='spinner-blade'></div>
        <div class='spinner-blade'></div>
        <div class='spinner-blade'></div>
        <div class='spinner-blade'></div>
        <div class='spinner-blade'></div>
        <div class='spinner-blade'></div>
        <div class='spinner-blade'></div>
        <div class='spinner-blade'></div>
        <div class='spinner-blade'></div>
        <div class='spinner-blade'></div>
        <div class='spinner-blade'></div>
        <div class='spinner-blade'></div>
      </div>
    </div>
  </div>
  {{/if}} 
</div>
</template>

<template name="serverImportSelectUser">
  <div class="server-import-select-user" style="display: none;">
    <div class="h">选择帐号</div>
    <div class="c">
      <dl>
        <dt class="active" userId="{{currentUser._id}}"><img src="{{currentUser.profile.icon}}" alt="Avatar"><i class="fa fa-check-circle"></i></dt>
        <dd>
            {{#if currentUser.profile.fullname}}
                {{currentUser.profile.fullname}}
            {{else}}
                {{currentUser.username}}
            {{/if}}
        </dd>
      </dl>
      {{#each accountList}}
        <dl>
          <dt userId="{{toUserId}}" userIcon="{{toIcon}}" userName="{{toName}}"><img src="{{toIcon}}" alt="Avatar"><i class="fa fa-check-circle"></i></dt>
          <dd>
              {{toName}}
          </dd>
        </dl>
      {{/each}}      
    </div>
    <div class="f"><button type="button" id="modalServerPublish" class="btn btn-primary">发表</button></div>
  </div>
</template>